<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>

		<!-- Evidencija prijevoda -->
		<record id="lingua_evidencija_tree_view" model="ir.ui.view">
			<field name="name">"lingua_evidencija_tree_view"</field>
			<field name="model">lingua.evidencija</field>
			<field name="arch" type="xml">
				<tree
					colors="black:state =='draft';
				              blue:state in ('open','process');
                              green:state == 'finished';
                              gray:state =='delivered'
                              red:state == 'canceled'"
					string="Evidention">
					<field name="partner_id" />
					<field name="name" />
					<field name="broj_evidencije" />
					<field name="fiskal_prostor_id" />


					<field name="date_recived" />
					<field name="date_due" />
					<!-- field name="time_remain" /> -->
					<field name="state" />

				</tree>
			</field>
		</record>

		<record id="lingua_evidencija_form_view" model="ir.ui.view">
			<field name="name">lingua_evidencija_form_view</field>
			<field name="model">lingua.evidencija</field>
			<field name="arch" type="xml">
				<form string="Evidention" version="7.0">
					<header>
						<!-- button name="button_recive" type="object" string="Zaprimi prijevod" 
							attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_highlight" /> -->
						<button name="button_recive" type="object" string="Recive translation" />
						<button name="button_evid_2_saleorder" type="object"
							string="Make Quotation" attrs="{'invisible':[('state', '==', 'draft')]}" />
						<field name="state" widget="statusbar" />

					</header>
					<sheet>
						<h1>
							<field name="seq_no" class="oe_inline" readonly="1" />
						</h1>
						<group colspan="4">
							<field name="name" />
							
							<field name="fiskal_prostor_id" />
							
							<field name="partner_id" />
							<field name="date_recived" help="Leave blank to autofill with current date/time on save"/>
							<field name="date_due" />
							<field name="marketing_id" />
                            
						</group>
						<notebook colspan="4">
							<page string="Translations">
								<group>
									<field name="lang_origin" string="Origin language" />
									<field name="type_id" />
									<field name="trans_card" />
									
								</group>
								<newline />
								<field name="evidencija_line_ids" colspan="4" nolabel="1"
									attrs="{'invisible': [('lang_origin', '=', False)]}" >
									<form>
										<field name="state" invisible="1" />
										<!-- <field name="evidencija_origin" /> -->
										<field name="language_id" domain="[('translator_ids', '!=', False )]"/>
										<field name="lectoring" />
										<!-- field name="translator_id" class="oe_inline" attrs="{'invisible': 
											[('language_id', '=', False)]}" /!> -->

									</form>
									<tree
										colors="blue:state == 'new';
                                                black:state in ('translation','lectoring');
                                                gray:state in ('cancel','pause');
                                                green:state == 'finished'"
										string="Evidention line">
										<field name="name" />
										<field name="language_id" />
										<field name="lectoring" />
										<field name="state" />
									</tree>
								</field>
							</page>
							<page string="Note">
							     <group>
							     <field name="broj_evidencije" />
							    <field name="broj_evidencija_pod" />
								<field name="note" colspan="4" />
								</group>
							</page>
							<page string="Accounting">
								<group>
                                    <field name="price_id" />
									<field name="sale_order" nolabel="1" colspan="4" />
									<newline />
									<field name="invoice" readonly="1" />
								</group>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>
		<record id="lingua_evidencija__filter" model="ir.ui.view">
			<field name="name">lingua.evidencija.select</field>
			<field name="model">lingua.evidencija</field>
			<field name="arch" type="xml">
				<search string="Search translation evidention">
					<field name="name"
						filter_domain="['|','|',('name','ilike',self),('parent_id','ilike',self),('ref','=',self)]" />
					<filter name="state" string="Finished" domain="[('state','=','finished')]" />
					<filter name="state" string="Processing" domain="[('state','=','process')]" />
					<group expand="0" string="Group By...">
						<filter string="Chapter" context="{'group_by' : 'fiskal_prostor_id'}" />
						<separator />
						<filter string="Company" context="{'group_by': 'partner_id'}" />
						<filter string="Status" context="{'group_by': 'state'}" />
					</group>
				</search>
			</field>
		</record>

		<!-- Evidencija Line -->
		<record id="lingua_evidencija_line_tree_view" model="ir.ui.view">
			<field name="name">"lingua_evidencija_line_tree_view"</field>
			<field name="model">lingua.evidencija.line</field>
			<field name="arch" type="xml">
				<tree create="false" delete="false" 
					colors="blue:state == 'new';
				black:state in ('translation','lectoring');
				gray:state in ('cancel','pause');
				green:state == 'finished'"
					string="Evidention line" >  <!-- editable="bottom" -->
					<field name="partner_id" />
					<field name="name" readonly="1" />
					<field name="evidencija_id" invisible="1" />
					<field name="language_id" />
					<!-- field name="employee_id" on_change="onchange_employee_id(employee_id)" 
						domain="[('language_ids','=',language_id)]" /> -->

					<field name="finish_due" />
					<field name="product_id" readonly="1" />
					<field name="state" readonly="1" />
					<field name="error" />
				</tree>
			</field>
		</record>
		<record id="lingua_evidencija_line_form_view" model="ir.ui.view">
			<field name="name">lingua_evidencija_line_form_view</field>
			<field name="model">lingua.evidencija.line</field>
			<field name="arch" type="xml">
				<form string="Evidention line" version="7.0">
					<header>
						<button name="button_translation_start" type="object"
							states="asign,pause" string="Start translating" />
						<button name="button_translation_finish" type="object"
							states="translate" string="Finish translating" />
						<button name="button_lectoring_start" type="object" states="lecture,pause"
							string="Start lecture" />
						<button name="button_lectoring_finish" type="object"
							states="lecture" string="Finish lecture" />
						<button name="button_pause" type="object" states="lecture,translate"
							string="Pause" />
						<field name="state" widget="statusbar" statusbar_colors='{"pause":"red","cancel":"red"}' />
					</header>
					<sheet>
						<h1>
							<label string="Task " />
							<field name="name" readonly="1" class="oe_inline" />
						</h1>
						<group>
							<field name="evidencija_id" readonly="1" />
							<field name="language_origin" readonly="1" />
							<field name="language_id" readonly="1"/>
							<!-- field name="employee_id" on_change="onchange_employee_id(employee_id)" 
								/> -->
							<field name="lectoring" />

						</group>
						<notebook colspan="4">
							<page string="Assigned translators">
								<field name="translator_ids" nolabel="1" on_change="onchange_employee_id(translator_ids)" />
							</page>
							<page string="Assigned lectors" 
                                    attrs="{'invisible': [('lectoring', '==', False)]}">
								<field name="lector_ids" nolabel="1" on_change="onchange_employee_id(lector_ids)"/>
							</page>
							<page string="Time evidention" col="4">
								<group>
									<field name="translation_start" />
									<field name="translation_finish" />
									<field name="lectoring_start" attrs="{'invisible': [('lectoring', '==', False)]}" />
									<field name="lectoring_finish" attrs="{'invisible': [('lectoring', '==', False)]}"/>
								</group>
							</page>
							<page string="Accounting">
								<group>
									<field name="product_type" readonly="1" />
									<field name="product_id" readonly="1" />

									<button name="button_translation2product" type="object"
										string="Convert to product" attrs="{'invisible': [('product_id', '!=', False)]}" />

								</group>
							</page>
							<page string="Error evidention">
								<field name="error" colspan="4" nolabel="1" />
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>

		<record id="lingua_evidencija_line_filter" model="ir.ui.view">
			<field name="name">lingua.evidencija.line.select</field>
			<field name="model">lingua.evidencija.line</field>
			<field name="arch" type="xml">
				<search string="Search translation task">

					<field name="name"
						filter_domain="['|','|',('name','ilike',self),('parent_id','ilike',self),('ref','=',self)]" />
					<!-- Filteri -->
					<filter name="state" string="Not started" domain="[('state','=','asigned')]" />
					<filter name="state" string="In translation" domain="[('state','=','translation')]" />
					<filter name="state" string="Lectoring" domain="[('state','=','lectoring')]" />
					<filter name="state" string="Finished" domain="[('state','=','finished')]" />
					<!-- Grupiranje -->
					<group expand="0" string="Group By...">
						<filter string="Language" domain="[]"
							context="{'group_by' : 'language_id'}" />
						<filter string="Translator" context="{'group_by': 'employee_id'}" />
						<separator />
						<filter string="Company" context="{'group_by': 'partner_id'}" />
						<filter string="Status" context="{'group_by': 'state'}" />
					</group>
				</search>
			</field>
		</record>

		<!-- Evidencija ERROR -->
		<record id="lingua_error_tree_view" model="ir.ui.view">
			<field name="name">"lingua_error_tree_view"</field>
			<field name="model">lingua.error</field>
			<field name="arch" type="xml">
				<tree string="Error Evidention">
					<field name="name" />
					<field name="reported_by" />
					<field name="reported_date" />
					<field name="description" />
					<field name="evidencija_line" />

				</tree>
			</field>
		</record>

		<record id="lingua_error_form_view" model="ir.ui.view">
			<field name="name">lingua_error_form_view</field>
			<field name="model">lingua.error</field>
			<field name="arch" type="xml">
				<form string="Error Evidention" version="7.0">
					<sheet>
						<group>
							<field name="name" />
							<field name="reported_by" />
							<field name="reported_date" />
							<field name="description" />
							<field name="evidencija_line" />
						</group>
					</sheet>
				</form>
			</field>
		</record>

		<!-- Evidencija TYPE -->
		<record id="lingua_translation_type_tree_view" model="ir.ui.view">
			<field name="name">"lingua_translation_type_tree_view"</field>
			<field name="model">lingua.translation.type</field>
			<field name="arch" type="xml">
				<tree string="Translation type">
					<field name="name" />
					
				</tree>
			</field>
		</record>

		<record id="lingua_translation_type_form_view" model="ir.ui.view">
			<field name="name">lingua_translation_type_form_view</field>
			<field name="model">lingua.translation.type</field>
			<field name="arch" type="xml">
				<form string="Translation type" version="7.0">
					<sheet>
						<group>
							<field name="name" />
							<field name="evidention_ids" readonly="1"/>
						</group>
					</sheet>
				</form>
			</field>
		</record>



		<!-- Menu Actions -->
		<record id='lingua_translations_evidention' model='ir.actions.act_window'>
			<field name="name">Translation Evidention</field>
			<field name="res_model">lingua.evidencija</field>
			<field name="view_mode">tree,form</field>
		</record>
		<record id='lingua_translations_evidention_line' model='ir.actions.act_window'>
			<field name="name">Translation tasks</field>
			<field name="res_model">lingua.evidencija.line</field>
			<field name="view_mode">tree,form</field>
			<field name="domain">[('name','!=', False)]</field>
		</record>
		<record id='lingua_error_evidention' model='ir.actions.act_window'>
			<field name="name">Error evidention</field>
			<field name="res_model">lingua.error</field>
			<field name="view_mode">tree,form</field>
		</record>
		<record id='lingua_translation_type' model='ir.actions.act_window'>
            <field name="name">Translation types</field>
            <field name="res_model">lingua.translation.type</field>
            <field name="view_mode">tree,form</field>
        </record>

		<!-- Server Actions -->
		<!-- Evidention action -->
		<record id="lingua_evidention_2_order" model="ir.actions.server">
			<field name="name">Evidentions to order</field>
			<field name="type">ir.actions.server</field>
			<field name="model_id" ref="model_lingua_evidencija" />
			<field name="state">code</field>
			<field name="code">self.action_multi_evidention_2_order(cr, uid,
				context.get('active_ids'), context=context)
			</field>
		</record>
		<record id="lingua_evidention_2_order_value" model="ir.values">
			<field name="name">Lines to order</field>
			<field name="action_id" ref="lingua_evidention_2_order" />
			<field name="value"
				eval="'ir.actions.server,' + str(ref('lingua_evidention_2_order'))" />
			<field name="key">action</field>
			<field name="model_id" ref="model_lingua_evidencija" />
			<field name="model">lingua.evidencija</field>
			<field name="key2">client_action_multi</field>
		</record>
		<!-- Translation LINE action -->
		<record id="lingua_translation_lines_2_order" model="ir.actions.server">
			<field name="name">Lines to order</field>
			<field name="type">ir.actions.server</field>
			<field name="model_id" ref="model_lingua_evidencija_line" />
			<field name="state">code</field>
			<field name="code">self.action_multiline_order(cr, uid,
				context.get('active_ids'), context=context)
			</field>
		</record>
		<record id="lingua_translation_lines_2_order_value" model="ir.values">
			<field name="name">Lines to order</field>
			<field name="action_id" ref="lingua_translation_lines_2_order" />
			<field name="value"
				eval="'ir.actions.server,' + str(ref('lingua_translation_lines_2_order'))" />
			<field name="key">action</field>
			<field name="model_id" ref="model_lingua_evidencija_line" />
			<field name="model">lingua.evidencija.line</field>
			<field name="key2">client_action_multi</field>
		</record>

		<!-- MENU ITEMS -->
		<menuitem name="Translations" id="menu_translations"
			sequence="10" />
		<menuitem name="Overwiev" id="translations_overview" parent="menu_translations" />
		<menuitem action="lingua_translations_evidention" parent="translations_overview"
			id="translations_evidention_menu" sequence="10" />

		<menuitem action="lingua_translations_evidention_line"
			parent="translations_overview" id="translations_evidention_line_menu"
			sequence="20" />
		<menuitem action="lingua_error_evidention" parent="translations_overview"
			id="translation_errors_evidention_menu" sequence="30" />
		<menuitem action="lingua_translation_type" parent="translations_setup"
            id="translation_types_menu"  />
	</data>
</openerp>
 
